{% extends 'base.html' %}
{% load static %}
{% block title %}
    Dashboard
{% endblock  %}
{% block content %}
<div>
    <div class="flex bg-gray-100 min-h-screen">
        {% comment %} <nav class="fixed top-0 left-0 h-full w-24 hidden md:flex flex-col items-center bg-gray-800 py-4 z-10">
            <!-- Left side NavBar -->
    
            <a href='/'>
                <!-- App Logo -->
    
                <svg
                    class="h-8 w-8 fill-current text-primary-300"
                    viewBox="0 0 24 24">
                    <path
                        d="M12 3L1 9l4 2.18v6L12 21l7-3.82v-6l2-1.09V17h2V9L12 3m6.82
                        6L12 12.72 5.18 9 12 5.28 18.82 9M17 16l-5 2.72L7 16v-3.73L12
                        15l5-2.73V16z"></path>
                </svg>
    
            </a>
    
            <ul class="mt-2  text-gray-400 capitalize">
                <!-- Links -->
    
                <li class="mt-3 p-2 text-primary-300 rounded-lg">
                    <a href="#" class=" flex flex-col items-center">
                        <svg class="fill-current h-5 w-5" viewBox="0 0 24 24">
                            <path
                                d="M19 5v2h-4V5h4M9 5v6H5V5h4m10 8v6h-4v-6h4M9
                                17v2H5v-2h4M21 3h-8v6h8V3M11 3H3v10h8V3m10
                                8h-8v10h8V11m-10 4H3v6h8v-6z"></path>
                        </svg>
                        <span class="text-xs mt-2">dashBoard</span>
                    </a>
    
                </li>
                <li
                    class="mt-3 p-2 hover:text-primary-600 dark-hover:text-primary-300
                    rounded-lg">
                    <a
                        href="/earnings/"
                        class=" flex flex-col items-center">
                        <svg class="fill-current h-5 w-5" viewBox="0 0 24 24">
                            <path
                                d="M21 18v1a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0
                                012-2h14a2 2 0 012 2v1h-9a2 2 0 00-2 2v8a2 2 0 002
                                2m0-2h10V8H12m4 5.5a1.5 1.5 0 01-1.5-1.5 1.5 1.5 0
                                011.5-1.5 1.5 1.5 0 011.5 1.5 1.5 1.5 0 01-1.5 1.5z"></path>
                        </svg>
                        <span class="text-xs mt-2">earnings</span>
                    </a>
    
                </li>
    
                <li
                    class="mt-3 p-2 hover:text-primary-600 dark-hover:text-primary-300
                    rounded-lg">
                    <a href="/tasks/" class=" flex flex-col items-center">
                        <svg class="fill-current h-5 w-5" viewBox="0 0 512 512">
                            <path
                                d="M505 442.7L405.3
                                343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7
                                44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208
                                208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7
                                17l99.7 99.7c9.4 9.4 24.6 9.4 33.9
                                0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7
                                0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128
                                57.2 128 128 0 70.7-57.2 128-128 128z"></path>
                        </svg>
                        <span class="text-xs mt-2">tasks</span>
                    </a>
    
                </li>
    
                <li
                    class="mt-3 p-2 hover:text-primary-600 dark-hover:text-primary-300
                    rounded-lg">
                    <a href="/post_job/" class=" flex flex-col items-center">
                        <svg class="fill-current h-5 w-5" viewBox="0 0 24 24">
                            <path
                                d="M19 19H5V8h14m0-5h-1V1h-2v2H8V1H6v2H5a2 2 0 00-2
                                2v14a2 2 0 002 2h14a2 2 0 002-2V5a2 2 0 00-2-2m-2.47
                                8.06L15.47 10l-4.88 4.88-2.12-2.12-1.06 1.06L10.59
                                17l5.94-5.94z"></path>
                        </svg>
                        <span class="text-xs mt-2">Post Gig</span>
                    </a>
    
                </li>
    
            </ul>
    
            <div
                class="mt-4 flex items-center p-2  bg-gray-200
                text-primary-500 rounded-full">
                <!-- important action -->
    
                <a href="/support/">
                    <svg class="fill-current h-5 w-5" viewBox="0 0 24 24">
                        <path
                            d="M12 1c-5 0-9 4-9 9v7a3 3 0 003 3h3v-8H5v-2a7 7 0 017-7
                            7 7 0 017 7v2h-4v8h4v1h-7v2h6a3 3 0
                            003-3V10c0-5-4.03-9-9-9z"></path>
                    </svg>
                    
                </a>
                
    
            </div>
    
        </nav> {% endcomment %}
        <div class="flex-grow text-gray-800">
          {% include 'nav.html' %}
          <main class="p-6 sm:p-4 space-y-6">
            
            <section class="grid grid-cols-2 lg:grid-cols-4 gap-6">
              <div class="flex items-center p-2 md:p-8 bg-white shadow rounded-lg">
                <div class="inline-flex flex-shrink-0 items-center justify-center h-8 w-8 md:h-16 md:w-16 text-purple-600 bg-purple-100 rounded-full mr-6">
                  <svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-6 w-6">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                  </svg>
                </div>
                <div>
                  <span class="block text-2xl font-bold">{{task_count}}</span>
                  <span class="block text-gray-500">{% if is_client %}Posted {% else %}Applied {% endif %} Tasks</span>
                </div>
              </div>
              <div class="flex items-center p-4 md:p-8 bg-white shadow rounded-lg">
                <div class="inline-flex flex-shrink-0 items-center justify-center h-8 w-8 md:h-16 md:w-16 text-green-600 bg-green-100 rounded-full mr-6">
                  <svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-6 w-6">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />
                  </svg>
                </div>
                <div>
                  <span class="block text-2xl font-bold">{{approved_count}}</span>
                  <span class="block text-gray-500">Approved</span>
                </div>
              </div>
              <div class="flex items-center p-4 md:p-8 bg-white shadow rounded-lg">
                <div class="inline-flex flex-shrink-0 items-center justify-center h-8 w-8 md:h-16 md:w-16 text-red-600 bg-red-100 rounded-full mr-6">
                  <svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-6 w-6">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 17h8m0 0V9m0 8l-8-8-4 4-6-6" />
                  </svg>
                </div>
                <div>
                  <span class="inline-block text-2xl font-bold">{{rejected_count}}</span>
                  <span class="inline-block text-xl text-gray-500 font-semibold">(-)</span>
                  <span class="block text-gray-500">Rejected</span>
                </div>
              </div>
              <div class="flex items-center p-4 md:p-8 bg-white shadow rounded-lg">
                <div class="inline-flex flex-shrink-0 items-center justify-center h-8 w-8 md:h-16 md:w-16 text-primary-600 bg-primary-100 rounded-full mr-6">
                  <svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-6 w-6">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
                  </svg>
                </div>
                <div>
                  <span class="block text-2xl font-bold">{{pending_count}}</span>
                  <span class="block text-gray-500">Pending Tasks</span>
                </div>
              </div>
            </section>
            <section class="md:grid flex flex-col grid-cols-2 md:grid-cols-2 lg:grid-cols-4 md:grid-rows-3 lg:grid-flow-col gap-6">
              <div class="flex flex-col md:col-span-2 md:row-span-2 bg-white shadow rounded-lg">
                <div class="flex items-center justify-between px-3 py-3 font-semibold border-b border-gray-100">
                  

                   
                  {% if is_client %}
                  <div>My Posted Jobs</div>
                  <a href='/posted_tasks/' type="button" class="inline-flex justify-center rounded-md px-1 -mr-1 bg-white text-sm leading-5 font-medium text-gray-500 hover:text-gray-600" id="options-menu" aria-haspopup="true" aria-expanded="true">
                    View all
                    <svg class="-mr-1 ml-1 h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                      <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                  </a>
                  {% else %}
                  <div>Posted Jobs</div>
                  <a href='/tasks/' type="button" class="inline-flex justify-center rounded-md px-1 -mr-1 bg-white text-sm leading-5 font-medium text-gray-500 hover:text-gray-600" id="options-menu" aria-haspopup="true" aria-expanded="true">
                    View all
                    <svg class="-mr-1 ml-1 h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                      <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                  </a>
                  {% endif %} 
                </div>
                <div class="p-2 flex-grow overflow-y-scroll" style="max-height: 12rem;">
                  {% if posted_tasks %}
                  <ul class="p-2 lg:py-4 lg:px-4 space-y-6 overflow-hidden">
                    {% for task in posted_tasks %}
                    <li class='border-b-2 py-1'>
                      <a class="flex items-center" href={{task.get_url}}>
                        <div class="h-10 w-10 mr-3 bg-gray-100 rounded-full overflow-hidden">
                          <img src="https://randomuser.me/api/portraits/women/82.jpg" alt="Annette Watson profile picture">
                        </div>
                        <span class="text-gray-600">{{task.title}}</span>
                        
                        <span class="ml-auto font-semibold">{% if is_client %}{{task.status}}{% else %}{{task.owner}}{% endif %}</span>
                      </a>
                    </li>
                    {% endfor %}
                  </ul>
                  {% else %}
                  <div class="flex items-center justify-center h-full px-4 py-16 text-gray-400 text-3xl font-semibold bg-gray-100 border-2 border-gray-200 border-dashed rounded-md">No Jobs</div>
                  {% endif %}
                </div>
              </div>
              <div class="flex items-center p-2 bg-white shadow rounded-lg">
                <div class="inline-flex flex-shrink-0 items-center justify-center h-8 w-8 md:h-16 md:w-16 text-warning-600 bg-warning-100 rounded-full mr-6">
                  <svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-6 w-6">
                    <path fill="#fff" d="M12 14l9-5-9-5-9 5 9 5z" />
                    <path fill="#fff" d="M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z" />
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l9-5-9-5-9 5 9 5zm0 0l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14zm-4 6v-7.5l4-2.222" />
                  </svg>
                </div>
                <div>
                  <span class="block text-xl font-bold"> &#8358;{{profile.earnings|floatformat:'2g'}}</span>
                  <span class="block text-gray-500">Earnings</span>
                </div>
              </div>
              <div class="flex items-center p-2 bg-white shadow rounded-lg">
                <div class="inline-flex flex-shrink-0 items-center justify-center h-8 w-8 md:h-16 md:w-16 text-teal-600 bg-teal-100 rounded-full mr-6">
                  <svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-6 w-6">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                </div>
                <div>
                  <span class="block text-xl font-bold"> &#8358;{{profile.wallet_balance|floatformat:'2g'}}</span>
                  <span class="block text-gray-500">Wallet Balance</span>
                </div>
              </div>
              <div class="row-span-3 col-span-2 lg:col-span-2 lg:col-end-5 bg-white shadow rounded-lg">
                <div class="flex items-center justify-between px-6 py-5 font-semibold border-b border-gray-100">
                  <span>Recent Job Applications</span>
                  <a href='/applications/' type="button" class="inline-flex justify-center rounded-md px-1 -mr-1 bg-white text-sm leading-5 font-medium text-gray-500 hover:text-gray-600" id="options-menu" aria-haspopup="true" aria-expanded="true">
                    View all
                    <svg class="-mr-1 ml-1 h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                      <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                  </a>
                  <!-- Refer here for full dropdown menu code: https://tailwindui.com/components/application-ui/elements/dropdowns -->
                </div>
                <div class="overflow-y-auto h-full p-2 lg:p-6 space-y-6" style="max-height: 24rem;">
                  {% if applications %}
                  <ul>
                    {% for application in applications %}
                    <li >
                      <a class="flex items-center p-2" href={{application.get_url}}>
                        <div class="h-10 w-10 mr-3 bg-gray-100 rounded-full overflow-hidden">
                          <img src="https://randomuser.me/api/portraits/women/82.jpg" alt="Annette Watson profile picture">
                        </div>
                        <span class="text-gray-600">{{application.user.username}}</span>
                        <span class="ml-auto font-semibold">{{application.task.title}}</span>
                        <span class="ml-auto font-semibold">{{application.status}}</span>
                      </a>
                    </li>
                    {% endfor %}
                  </ul>
                  {% else %}
                  <div class="text-center flex items-center flex-grow justify-center px-4 py-16 text-gray-400 text-3xl font-semibold">No Recent Applications</div>
                  {% endif %}
                </div>
                
              </div>
              
            </section>
            <div class='gap-4 grid md:grid-cols-1 justify-center'>
              <div class='bg-white shadow rounded-lg flex flex-col items-center'>
                <h3 class="text-lg  my-4 font-medium text-center text-gray-900">STATS</h3>
                {% if task_count %}
                <canvas id="myChart" style="width:50%;max-width:700px"></canvas>
                {% else %}
                <div class=" text-center flex items-center flex-grow justify-center px-4 py-16 mx-5 text-gray-400 text-3xl font-semibold">No Tasks</div>
                {% endif %}
              </div>
            </div>
          </main>
          
        </div>
      </div>
</div>
{% block scripts %}
<script
src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js">
</script>
<script>
  var xValues = ["Approved", "Rejected", "Pending"];
var yValues = [{{approved_count}}, {{rejected_count}}, {{pending_count}}];
var barColors = [
  "#18db87",
  "#c41f1f",
  "#e8d613",
];

new Chart("myChart", {
  type: "pie",
  data: {
    labels: xValues,
    datasets: [{
      backgroundColor: barColors,
      data: yValues
    }]
  },
  options: {
    title: {
      display: true,
      text: {%  if user.role == 'CLIENT' %} "Job Approval Rate" {% else %} 'Job Completion Rate'{% endif %},
    }
  }
});

</script>
{% endblock %}
{% endblock %}
